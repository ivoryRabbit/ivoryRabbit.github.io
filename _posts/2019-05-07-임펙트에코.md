---
layout: post
title:  "Impact echo 데이터 분석"
date:   2019-05-07 16:05:59
author: ivoryRabbit
categories: 연구
comments: true
tag: impact echo
---

* * *

졸업 후 군대가기 전까지 기초과학연구소에서 데이터 분석 관련 일(일이라 적고 공부라 읽는다)을 하게 되었다. 비파괴 실험을 통해 콘크리트 밑에 균열이 있는지 없는지 알아내는 연구(Impact Echo)로, 사람이 손으로 계산하던 알고리즘을 대신하여 딥러닝을 적용해보고 있다.

* * *

### 연구 개요

우리의 첫번째 목표는 콘크리트 아래에 균일이 "있는지" vs "없는지"에 대한 분류인데 전처리 과정에서부터 쉽지 않았다. 실험 데이터를 불러와 딥러닝에 적합한 포멧으로 바꾸어 준 후, 데이터 불균형 문제를 해결하기 위해 데이터 어그멘테이션을 시도했지만 크게 결과가 달라지지 않았다. 데이터를 수집하는데 있어서 직접적인 참여가 불가능했기에, 가지고 있는 데이터로만 성능을 최대화시켜야 했다.

* * *

### 데이터 전처리

각각의 관측치는 0.1초의 시간을 10000개로 나누어 기록되있었고, 데이터의 개수도 만개가 넘게 수집되었다. 이 데이터를 그대로 사용하기에는 너무 차원이 크기 때문에 다음과 같은 방법을 시도해보았다.

1. Average window의 방법으로 길이를 1000정도로 줄여 사용
2. PCA 차원 축소법
3. Short-Time Fourier Transform 후 역 푸리에 변환
4. 딥러닝으로 간단한 Auto-regressive model 이용

데이터 셋 분리(train - valid - test)에 대해서는 최대한 서로 영향을 미치지 않도록 분리한 후, 데이터 불균형 문제가 존재하므로 F1 스코어를 사용하기로 결정했다.

* * *

### 데이터 어그멘테이션과 샘플링

진동하는 데이터를 푸리에 변환시킨 후, 같은 카테고리에 묶여 있는 데이터끼리 평균을 내어 역푸리에 변환하였다. 이는 impact echo를 이용해 균열을 탐지하는 전통적인 방식이 푸리에 변환을 통해 얻은 주파수를 분석한다는 것에 기인한 것이다. 샘플링은 데이터가 월등히 많은 쪽의 데이터를 실험날짜 별로 랜덤샘플링하였다.

* * *

### 모델

+ keras를 이용한 casual 1D-CNN 구현
+ 5 classification

* * *

### 실험환경

개인 노트북에서 대부분의 전처리와 학습을 시행하였고, 모델에 따른 성능차는 google colab을 이용해 학습 및 비교하였다.

* * *

### 결과

- Accuracy: 0.87
- F1-score: 0.82 ~ 0.92
