---
layout: post
title:  "R 사용기(1)"
date:   2019-12-03
author: ivoryRabbit
categories: 개발
description: "R을 사용해 보았습니다"
comments: true
---

# R과 Python

안녕하세요. 저는 최근 육군 모 교육기관에서 데이터 분석 업무를 하고 있습니다.

군 특성상 데이터 분석에 활용할 수 있는 부분이 제한적이라 Python 보다는 R을 더 많이 활용하고 있는 편입니다.

제가 처음 R을 접한 것은 무려 5년 전입니다. 2014년도 한 수리통계학 수업에서 R을 이용해 몬테카를로 추정 등을 실습한 기억이 있습니다.

당시 통계학 교수님께서는 $pi$값을 근사하기 위해 정사각형 속에 점을 찍어 내접원에 포함된 점의 개수를 구하는 모습을 보여주셨습니다.

그때는 메모장 같이 생긴 콘솔창에서 코딩하는 모습때문인지 

 
 그 이후 Python에 또 다시 빠지게 된 계기가 있었는데, 무려 2년 후인 2018년이다. Python에는 **pandas** 라는, 데이터를 아주 다루기 쉽게 해주는 패키지가 있다. 특히 pandas profiling report를 이용해 데이터를 보기좋게 요약하는 기능이 쏠쏠하다. 아무튼 이때 처음으로 데이터 과학(data science)이라는 분야를 알게되었고, 취미로라도 개발을 해보고 싶어서 머신러닝을 공부했었다.

 보통 Python을 이용하다보면 **for** 이나 **while** 구문, 그러니까 iteration에 익숙해진다. 그런데 pandas를 이용해 데이터를 막 만지다보면 **for**을 사용하는 것이 최악이라는 것을 느끼게 된다. apply 계열 함수를 사용하거나 numpy처럼 배열(array)연산을 지원하는 함수를 사용하면 **for**을 돌리는 것보다 30배에서 1000배 가까이 빠르다. 
 
 이런 깨달음을 몸소 느낀 후에야 R을 다시 접하게 되었는데, 참으로 다행이라는 생각이 들었다. 왜냐하면 R에서 주로 다룰 자료구조는 dataframe이며, 나의 깨달음은 dataframe을 잘 활용하는데 있어서 핵심이기 때문이다. R에서 dataframe에 대한 이해가 높이지니 덩달아 Python에서 pandas에 대한 이해도 높아졌다.

R을 다시 사용하면서 느낀 장점은 파이프연산자(%>%)였다. 파이프연산자를 이용하면

```R
arrange(summarise(group_by(select(df, column1, column2), column1), column2 = mean(column2)), column2)
```
대신
```R
df %>%
  select(column1, column2) %>%
  group_by(column1) %>%
  summarise(column2 = mean(column2)) %>%
  arrange(desc(column2))
```
으로 문법의 간결성을 꾀할 수 있습니다.

참고로 Python의 pandas에서는 dataframe 객체에 계속해서 함수를 호출해서 사용할 수 있다. 위의 코드와 대응하는 Python 코드는 다음과 같다.

```python
df[['column1', 'column2']].\
  groupby(['column1'], as_index = False).\
  mean().\
  sort_values(by = 'column2', ascending = False)
```
참고로 dot(.)은 객체를 호출하고, backslash(\\)는 개행을 하는 역할이다. R처럼 파이프연산자를 사용하기 위한 다른 방법으로는, **dplython** 라이브러리를 이용하여 파이프연산자(>>)를 사용하거나 pandas에 내장된 **pipe()** 함수를 사용하면 된다. 

시각화에 관해서도 R이 굉장히 편리하다는 생각이 들었다. 처음에는 피라미드 그래프를 그리는데도 고생했지만 점점 익숙해지고 있다. 조만간 **ggplot2**뿐만 아니라 **plotly**와 **bokeh**를 공부하여 써먹어 볼 것이다.

* * *
## 데이터 구조에 따른 분석방법

독립변수 | 종속변수 | 분석방법
:-- | :-- | --:
범주형 | 범주형 | 카이제곱검정
범주형 | 연속형 | t - 검정 / 분산분석(ANOVA)
연속형 | 범주형 | 로지스틱 회귀분석 / Softmax
연속형 | 연속형 | 선형 / 다중 회귀분석 / 구조방정식
범주형 + 연속형 | 범주형 | 로지스틱 회귀분석 / Decision Tree 기반 학습
범주형 + 연속형 | 연속형 | 공분산분석(ANCOVA)
