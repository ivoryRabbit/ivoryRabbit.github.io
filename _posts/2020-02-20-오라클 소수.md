---
layout: post
title: "오라클과 소수(Prime)"
date: 2020-02-20 23:45:59
author: ivoryRabbit
categories: 개발
comments: true
tag: SQL
---

# 오라클로 소수 골라내기

**HackerRank**에서 1000보다 작은 소수를 뽑는 문제가 나와서 이를 Oracle을 이용해 풀어보았다.

```{sql}
SELECT A.Num
  FROM (SELECT LEVEL + 1 AS Num FROM DUAL CONNECT BY LEVEL < 1000) A
     , (SELECT LEVEL AS Den FROM DUAL CONNECT BY LEVEL <= SQRT(1000)) B
 WHERE A.Num >= POWER(B.Den, 2)
   AND MOD(A.Num, B.Den) = 0
 GROUP BY A.Num
HAVING COUNT(*) = 1
 ORDER BY A.Num;
```

또는

```{sql}
  WITH T as (SELECT LEVEL + 1 AS Num FROM DUAL CONNECT BY LEVEL < 1000)
SELECT LISTAGG(A.Num, '&') WITHIN GROUP(ORDER BY A.Num)
  FROM T A
 WHERE NOT EXISTS (SELECT * FROM T B WHERE A.Num > B.n AND MOD(A.Num, B.Num) = 0);
```
