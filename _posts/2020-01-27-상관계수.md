---
layout: post
title:  "상관관계와 상관계수"
date:   2020-01-27 14:36:59
author: ivoryRabbit
categories: 수학
comments: true
tag: 통계
---

# 상관계수(correlation coefficient)

두 변수(variable)가 얼마나 상관관계가 있는지 측정하는 척도이다. 상관계수가 반드시 **선형적이다**의 의미를 포함하고 있진 않지만, 대부분의 상관계수가 선형성을 측정하고 있는 피어슨 상관계수로부터 비롯되고 있다. 추천시스템(recomendation system)의 협력 필터링(collaborative filtering)에서 두 아이템 혹은 두 고객의 유사도(similarity)를 계산하거나, 추천이 얼마나 성공적인지 계산하는 평가함수(evaluation function)으로 사용된다.

## 1. 피어슨(Pearson) 상관계수

두 변수 X와 Y에 대해 각각 3개의 다음과 같은 관측치가 있다고 하자.

$$ X = (1, 2, 3)\\ Y = (4, 5, 6) $$

우리는 두 변수 $X$와 XY$에 따라 다음과 같은 척도(scale), $\rho$를 만들어 측정하고 싶다.

- $X$가 커짐에 따라 $Y$가 커지면, 높은 값의 $\rho$를 가짐
- $X$가 커짐에도 불구하고 $Y$가 제멋대로라면, 낮은 값의 $\rho$를 가짐
- $X$가 커짐에 따라 $Y$가 작아지면, 훨씬 더 낮은 값의 $\rho$를 가짐

주어진 $X$와 $Y$를 벡터(vector)라고 생각하면, 우리는 위의 세가지를 모두 충족시키는 척도를 이미 알고 있다. 바로 **내적(inner product)**이다. 실제로 내적을 계산해보면 다음을 얻게된다.

$$\langle X, Y \rangle = (1 * 4) + (2 * 5) + (3 * 6) = 32$$

32라는 값은 $X$와 $Y$의 나열 순서를 달리할 때 얻을 수 있는 가장 큰 내적 값이다. 무슨말이냐하면, $X$를 고정하고 $Y = (6, 5, 4)$로 순서를 섞으면 내적값은 32보다 작다.

$$\langle X, Y \rangle = (1 * 6) + (2 * 5) + (3 * 4) = 28 < 32$$

어떻게 순서를 나열하더라도 32라는 값을 넘기지 못하는 이러한 성질은 간단한 방법으로 증명할 수 있다.

**_proof_**

Let $X = (x_1, x_2, \ldots, x_n)$ and $Y = (y_1, y_2, \ldots, y_n)$ be given. We will show that the inner product $\langle X, Y \rangle = \sum_{i=1}^n x_i \cdot y_i$ of $X$ and $Y$ is the maximum when $X$ and $Y$ are both increasing.

Suppose that $x_i \leq x_j$ and $y_i \leq y_j$ for all $i<j$, that is, increasing. Then $x_n$ an $y_n$ are the greatest numbers of $X$ and $Y$, respectively. 

For any $i,j < n$, consider two equations $x_n \cdot y_n + x_i \cdot y_j$ and $x_n \cdot y_j + x_i \cdot y_n$. Then we obatin $x_n \cdot y_n + x_i \cdot y_j \geq x_n \cdot y_j + x_i \cdot y_n$ by the following.

$$
\begin{aligned}
(x_n \cdot y_n + x_i \cdot y_j) - (x_n \cdot y_j + x_i \cdot y_n) &= x_n \cdot (y_n - y_j) - x_i \cdot (y_n - y_j)
\\ &= (x_n - x_i) \cdot (y_n - y_j) > 0
\end{aligned}
$$

Hence, $\max(\sum_{i=1}^n x_i \cdot y_i) = x_n \cdot y_n + \max(\sum_{i=1}^{n-1} x_i \cdot y_i)$ and the proof is done recursively.
